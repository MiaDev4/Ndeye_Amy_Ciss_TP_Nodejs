<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Liste des produits</title>
    <style>
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th,
      td {
        border: 1px solid #333;
        padding: 8px;
        text-align: center;
      }
      .rupture {
        background-color: #f8d7da;
      }
      nav a {
        margin-right: 150px;
        text-decoration: none;
        color: blue;
        border: 1px solid black;
        border-radius: 5px;
        padding: 5px 10px;
      }
      .btn-modifier {
        text-decoration: none;
        border: 1px solid black;
        border-radius: 5px;
        padding: 5px 10px;
        color: green;
      }
      .btn-supprimer {
        border: 1px solid black;
        border-radius: 5px;
        padding: 5px 10px;
        color: red;
      }
      .disabled {
        color: gray;
      }
    </style>
  </head>
  <body>
    <nav>
      <a href="/produits">Accueil</a>
      <a href="/ajouter">Ajouter</a>
      <a href="/recherche">Recherche</a>
    </nav>

    <h2>Liste des produits</h2>

    <table>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Prix (FCFA)</th>
        <th>Quantité</th>
        <th>Catégorie</th>
        <th>Actions</th>
      </tr>

      <% produits.forEach(p => { %>
      <tr class="<%= p.quantite === 0 ? 'rupture' : '' %>">
        <td><%= p.id %></td>
        <td><%= p.nom %></td>
        <td><%= p.prix %></td>
        <td><%= p.quantite %></td>
        <td><%= p.categorie %></td>

        <td>
          <a class="btn-modifier" href="/modifier/<%= p.id %>">Modifier</a>
          <% if (p.quantite === 0) { %>
          <form
            method="POST"
            action="/produits/<%= p.id %>/supprimer"
            onsubmit="return confirm('Voulez-vous vraiment supprimer ce produit ?');"
            style="display: inline">
            <button class="btn-supprimer">Supprimer</button>
          </form>

          <% } else { %>
          <!-- Afficher un bouton cliquable  -->
          <button disabled class="btn-supprimer">Supprimer</button>
          <% } %>
          
        </td>
      </tr>
      <% }) %>
    </table>
  </body>
</html>
